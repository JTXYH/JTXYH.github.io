(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{532:function(s,t,a){"use strict";a.r(t);var n=a(6),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"会话技术"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#会话技术"}},[s._v("#")]),s._v(" 会话技术")]),s._v(" "),a("ul",[a("li",[s._v("会话："),a("strong",[s._v("一次会话中包含多次请求和响应")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("一次会话")]),s._v("：浏览器第一次给服务器资源发送请求，会话建立，直到一方断开为止")])])]),s._v(" "),a("li",[s._v("功能：在一次会话范围内的多次请求间"),a("strong",[s._v("共享数据")])]),s._v(" "),a("li",[s._v("方式：\n"),a("ol",[a("li",[a("strong",[s._v("客户端")]),s._v("会话技术："),a("strong",[s._v("Cookie")])]),s._v(" "),a("li",[a("strong",[s._v("服务端")]),s._v("会话技术："),a("strong",[s._v("Session")])])])])]),s._v(" "),a("h2",{attrs:{id:"cookie"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cookie"}},[s._v("#")]),s._v(" Cookie")]),s._v(" "),a("ul",[a("li",[s._v("概念："),a("strong",[s._v("客户端")]),s._v("会话技术，将数据保存在客户端")])]),s._v(" "),a("h3",{attrs:{id:"使用："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用："}},[s._v("#")]),s._v(" 使用：")]),s._v(" "),a("ol",[a("li",[a("strong",[s._v("创建Cookie")]),s._v("，绑定数据\n"),a("ul",[a("li",[a("strong",[s._v("new Cookie(String name, String value)")])])])]),s._v(" "),a("li",[a("strong",[s._v("发送Cookie对象")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("response.addCookie(Cookie cookie)")])])])]),s._v(" "),a("li",[a("strong",[s._v("获取Cookie")]),s._v("，拿到数据\n"),a("ul",[a("li",[s._v("Cookie[] "),a("strong",[s._v("request.getCookies()")])])])])]),s._v(" "),a("h3",{attrs:{id:"实现原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实现原理"}},[s._v("#")]),s._v(" 实现原理")]),s._v(" "),a("p",[s._v("基于"),a("strong",[s._v("响应头set-cookie和请求头cookie实现")])]),s._v(" "),a("h3",{attrs:{id:"cookie细节"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cookie细节"}},[s._v("#")]),s._v(" cookie细节")]),s._v(" "),a("ul",[a("li",[s._v("一次可以发送多个cookie")]),s._v(" "),a("li",[a("strong",[s._v("保存时间")]),s._v(" "),a("ol",[a("li",[s._v("默认情况下，当"),a("strong",[s._v("关闭浏览器时cookie将被清除")])]),s._v(" "),a("li",[s._v("设置持久化存储：\n"),a("ul",[a("li",[a("strong",[s._v("serMaxAge(int seconds)")]),s._v(" "),a("ol",[a("li",[a("strong",[s._v("正数")]),s._v("：持久化存储，cookie的存活时间，秒数")]),s._v(" "),a("li",[a("strong",[s._v("负数")]),s._v("：默认值")]),s._v(" "),a("li",[a("strong",[s._v("零")]),s._v("：删除cookie信息")])])])])])])]),s._v(" "),a("li",[a("strong",[s._v("Tomcat8")]),s._v("之后支持中文存储")]),s._v(" "),a("li",[a("strong",[s._v("cookie共享问题")]),s._v("：\n"),a("ul",[a("li",[s._v("默认情况下cookie"),a("strong",[s._v("不能共享给其他web项目")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("setPath(String path)")]),s._v("：设置cookie的获取范围，默认情况下，设置当前虚拟目录")]),s._v(" "),a("li",[s._v("如果要共享则将path设置为**/**")])])]),s._v(" "),a("li",[s._v("不同的tomcat服务器之间cookie共享\n"),a("ul",[a("li",[a("strong",[s._v("setDomain(String path)")]),s._v("：设置"),a("strong",[s._v("一级域名相同")]),s._v("，那么多个服务器之间的cookie可以共享\n"),a("ul",[a("li",[a("em",[s._v("setDomain(.baidu.com)，这样设置后tieba.baidu.com和news.baidu.com中cookie可以共享")])])])])])])])])]),s._v(" "),a("h3",{attrs:{id:"cookie特点和作用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cookie特点和作用"}},[s._v("#")]),s._v(" cookie特点和作用")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("特点")]),s._v(" "),a("ol",[a("li",[s._v("cookie"),a("strong",[s._v("存储数据在客户端浏览器")])]),s._v(" "),a("li",[s._v("浏览器对于单个cookie的大小有限制，以及对同一个域名下的总的cookie数量也有限制(20个)")])])]),s._v(" "),a("li",[a("strong",[s._v("作用")]),s._v("：\n"),a("ol",[a("li",[s._v("cookie一般用于"),a("strong",[s._v("存储少量的不太敏感的数据")])]),s._v(" "),a("li",[s._v("在"),a("strong",[s._v("不登录的情况下")]),s._v("，完成服务器对客户端的识别")])])])]),s._v(" "),a("h3",{attrs:{id:"js手动清除cookie"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#js手动清除cookie"}},[s._v("#")]),s._v(" js手动清除cookie")]),s._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" keys "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cookie"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("match")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/[^ =;]+(?=\\=)/g")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\t\t\t\t\t\t\n        document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cookie "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'=0;expires='")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Date")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("toUTCString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("h2",{attrs:{id:"session"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#session"}},[s._v("#")]),s._v(" Session")]),s._v(" "),a("ul",[a("li",[s._v("概念："),a("strong",[s._v("服务器端会话技术")]),s._v("，在"),a("strong",[s._v("一次会话")]),s._v("的"),a("strong",[s._v("多次请求")]),s._v("间共享数据，将数据"),a("strong",[s._v("保存在服务器端")]),s._v("的对象中")])]),s._v(" "),a("h3",{attrs:{id:"基本方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本方法"}},[s._v("#")]),s._v(" 基本方法")]),s._v(" "),a("ol",[a("li",[s._v("Object "),a("strong",[s._v("getAttribute(String name)")]),s._v("："),a("strong",[s._v("获取")]),s._v("session对象")]),s._v(" "),a("li",[s._v("void "),a("strong",[s._v("setAttribute(String name,Objecr value)")]),s._v("："),a("strong",[s._v("设置")]),s._v("session对象")]),s._v(" "),a("li",[s._v("void "),a("strong",[s._v("removeAttribute(String name)")]),s._v("："),a("strong",[s._v("移除")]),s._v("session对象")])]),s._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpSession")]),s._v(" se "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getSession")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setSession")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"张三"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getSession")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("removeSession")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),a("h3",{attrs:{id:"原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#原理"}},[s._v("#")]),s._v(" 原理")]),s._v(" "),a("ul",[a("li",[s._v("Session的实现是"),a("strong",[s._v("依赖于Cookie的")])])]),s._v(" "),a("h3",{attrs:{id:"特点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#特点"}},[s._v("#")]),s._v(" 特点")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("当"),a("strong",[s._v("客户端关闭后，服务器不关闭")]),s._v("，两次获取的session默认"),a("strong",[s._v("不是同一个")])]),s._v(" "),a("ul",[a("li",[s._v("如果需要相同，则创建一个Cookie，键设置为"),a("strong",[s._v("JSESSIONID")]),s._v("，设置最大存活时间，让cookie持久化保存")])]),s._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Cookie")]),s._v(" c "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Cookie")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"JSESSIONID"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("session"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 设置一个Cookie")]),s._v("\nc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setMaxAge")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 设置最大存活时间")]),s._v("\nresponse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("addCookie")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])]),s._v(" "),a("li",[a("p",[s._v("当"),a("strong",[s._v("客户端不关闭，服务器关闭后")]),s._v("，两次获取的session"),a("strong",[s._v("不是同一个")])]),s._v(" "),a("ul",[a("li",[s._v("session的"),a("strong",[s._v("钝化")]),s._v("：在服务器正常关闭之前，将session对象序列化到硬盘上")]),s._v(" "),a("li",[s._v("session的"),a("strong",[s._v("活化")]),s._v("：在服务器启动后，将session文件转化为内存中的session对象")])])])]),s._v(" "),a("h3",{attrs:{id:"session的销毁"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#session的销毁"}},[s._v("#")]),s._v(" session的销毁")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("服务器关闭")])]),s._v(" "),a("li",[a("p",[s._v("session对象调用"),a("strong",[s._v("invalidate()")])])]),s._v(" "),a("li",[a("p",[s._v("session默认失效时间："),a("strong",[s._v("30分钟")])]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("修改默认失效时间")]),s._v("：目录"),a("strong",[s._v("tomcat/conf/web.xml里")])]),s._v(" "),a("div",{staticClass:"language-xml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("session-config")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("session-timeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("30"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("session-timeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("session-config")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])])])])])]),s._v(" "),a("li",[a("p",[s._v("session用于"),a("strong",[s._v("存储一次会话的多次请求的数据")]),s._v("，存在服务器")])]),s._v(" "),a("li",[a("p",[s._v("session可以"),a("strong",[s._v("存储任意类型，任意大小的数据")])])]),s._v(" "),a("li",[a("p",[s._v("session与Cookie区别：")]),s._v(" "),a("ul",[a("li",[s._v("session存在"),a("strong",[s._v("服务器")]),s._v("，cookie存在"),a("strong",[s._v("客户端")])]),s._v(" "),a("li",[s._v("session"),a("strong",[s._v("没有")]),s._v("数据大小限制，cookie"),a("strong",[s._v("有")])]),s._v(" "),a("li",[s._v("session数据"),a("strong",[s._v("安全")]),s._v("，cookie相对"),a("strong",[s._v("不安全")])])])]),s._v(" "),a("li",[a("p",[s._v("java中"),a("strong",[s._v("手动清除session")])]),s._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getSession")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("invalidate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])])])])}),[],!1,null,null,null);t.default=e.exports}}]);